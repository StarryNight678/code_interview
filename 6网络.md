# 网络

## 发送1M数据

使用TCP和UDP 各发送多少包

最大传输单元（英语：Maximum Transmission Unit，缩写MTU）是

以太网	MTU= 1500



MTU也不是越大越好，因为MTU越大， 传送一个数据包的延迟也越大；并且MTU越大，数据包中 bit位发生错误的概率也越大。

MTU越大，通信效率越高而传输延迟增大，所以要权衡通信效率和传输延迟选择合适的MTU。

以以太网传送IPv4报文为例。MTU表示的长度包含IP包头的长度，如果IP层以上的协议层发送的数据报文的长度超过了MTU，则在发送者的IP层将对数据报文进行分片，在接收者的IP层对接收到的分片进行重组。

这里举一个具体的例子说明IP包分片的原理。以太网的MTU值是1500 bytes，假设发送者的协议高层向IP层发送了长度为3008 bytes的数据报文，则该报文在添加20 bytes的IP包头后IP包的总长度是 3028 bytes，因为3028 > 1500，所以该数据报文将被分片，分片过程如下：

1. 首先计算最大的IP包中IP净荷的长度 =MTU-IP包头长度=1500-20= 1480 bytes。

2. 然后把3028 bytes按照1480 bytes的长度分片，将要分为3片，3028= 1480+1480+68。

3. 最后发送者将为3个分片分别添加IP包头，组成3个IP包后再发送，3个IP包的长度分别为1500 bytes、1500 bytes和 88 bytes。

从以上分片例子可以看出第一、二个分片包组成的IP包的长度都等于MTU即1500 bytes。

在网络通讯中，需要尽量避免发生分片和重组，因为分片重组对网络性能影响较大。数据包发送时选择合适的MTU大小对提高通讯性能很有必要。MTU大小的选择有协议协商方式，通过全路径的MTU发现机制，找到整条路径的最小MTU（也就是路径MTU），然后报文发送式小于等于路径MTU，这就避免了数据传输过程中产生分片，从而提高数据转发性能。MTU的协议发现机制由于安全等方面的原因，并不能总是生效，这时候就需要根据网络的特性选择

## TCP数据段格式  


20字节报头长度

![](http://img.blog.csdn.net/20140914125143862)

- 源、目标端口号字段：各占16比特。TCP协议通过使用"端口"来标识源端和目标端的应用进程。端口号可以使用0到65535之间的任何数字，但是这些端口号已经被分为公认端口、注册端口和动态/私有端口，这个划分详见下一篇博文。在收到服务请求时，操作系统动态地为客户端的应用程序分配端口号。在服务器端，每种服务在"众所周知的端口"（Well-Know Port）为用户提供服务。
- 顺序号字段：占32比特。用于标识每个报文段，使目的主机可确认已收到指定报文段中的数据。当源主机用于多个报文段发送一个报文时，即使这些报文到达目的主机的顺序不一样，序列号也可以使目的主机按顺序排列它们。
　　在建立连接时发送的第一个报文段中，双方都提供一个初始序列号。TCP标准推荐使用以4ms间隔递增1的计数器值作为这个初始序列号的值。使用计数器可以防止连接关闭再重新连接时出现相同的序列号。
　　对于那些包含数据的报文段，报文段中第一个数据字节的数量就是初始序列号，其后数据字节按顺序编号。如果源主机使用同样的连接发送另一个报文段，那么这个报文段的序列号等于前一个报文段的序列号与前一个报文段中数据字节的数量之和。例如，假设源主机发送3个报文段，每个报文段有100字节的数据，且第一个报文段的序列号是1000，那么第二个报文段的序列号就是1100（1000＋100），第三个报文段的序列号就是1200（1100＋100）。如果序列号增大至最大值将复位为0。    
- 确认号字段：占32比特。只有ACK标志为1时，确认号字段才有效。目的主机返回确认号，使源主机知道某个或几个报文段已被接收。如果ACK控制位被设置为1，则该字段有效。确认号等于顺序接收到的最后一个报文段的序号加1(建立连接时)或者加上一份数据的大小(数据传输时)，这也是目的主机希望下次接收的报文段的序号值。返回确认号后，计算机认为已接收到小于该确认号的所有数据。
　　例如，序列号等于前一个报文段的序列号与前一个报文段中数据字节的数量之和。例如，假设源主机发送3个报文段，每个报文段有100字节的数据，且第一个报文段的序列号是1000，那么接收到第一个报文段后，目的主机返回含确认号1100的报头。接收到第二个报文段（其序号为1100）后，目的主机返回确认号1200。接收到第三个报文段后，目的主机返回确认号1300。
　　目的主机不一定在每次接收到报文段后都返回确认号。在上面的例子中，目的主机可能等到所有3个报文段都收到后，再返回一个含确认号1300的报文段，表示已接收到全部1200字节的数据。但是如果目的主机再发回确认号之前等待时间过长，源主机会认为数据没有到达目的主机，并自动重发。
　　上面的例子中，如果目的主机接收到了报文段号为1000的第一个报文段以及报文段号为1200的最后一个报文段，则可返回确认号1100，但是再返回确认号1300之前，应该等待报文段号为1100的中间报文段。    
- 头部长度字段：占4比特。给出头部占32比特的数目。由于TCP报头的长度随TCP选项字段内容的不同而变化，因此报头中包含一个指定报头字段的字段。该字段以32比特为单位，所以报头长度一定是32比特的整数倍，有时需要在报头末尾补0。如果报头没有TCP选项字段，则报头长度值为5，表示报头一个有160比特，即20字节。    
- 标志位字段（U、A、P、R、S、F）：占6比特。各比特的含义如下：  

  1. URG：报文段紧急。    
  1. ACK：确认序号有效。    
  1. PSH：接收方应该尽快将这个报文段交给应用层。    
  1. RST：重建连接。    
  1. SYN：发起一个连接。在握手完成后SYN为1，表示TCP建立已连接。此后的所有报文段中，SYN都被置0。
  1. FIN：释放一个连接。如果源主机数据发送完毕，将把该连接下要发送的最后一个报文段的报头中的FIN位置1，或将该报文段后面发送的报头中该位置1。    

- 窗口大小字段：占16比特。此字段用来进行流量控制。单位为字节数，这个值是本机期望一次接收的字节数。接收计算机可接收的新数据字节的数量，根据接收缓冲区可用资源的大小，其值随计算机所发送的每个报文段而变化。源主机可以利用接收到的窗口值决定下一个报文段的大小。   
- TCP校验和字段：占16比特。对整个TCP报文段，即TCP头部和TCP数据进行校验和计算，并由目标端进行验证。    
- 紧急指针字段：占16比特。它是一个偏移量，和序号字段中的值相加表示紧急数据最后一个字节的序号。如果URG为1，则紧急指针标志着紧急数据的结束。其值是紧急数据最后1字节的序号，表示报文段序号的偏移量。例如，如果报文段的序号是1000，前8个字节都是紧急数据，那么紧急指针就是8。紧急指针一般用途是使用户可中止进程。    
- 选项字段：占32比特。可能包括"窗口扩大因子"、"时间戳"等选项。
- 数据部分：报头后面是可选的报文段数据部分。IP协议标准要求株距能接收最长达576字节的数据报。无其他选项的IP报头是20字节，无其他选项的TCP报头也是20字节，所以IP选项和TCP选项且含有多达536字节数据的TCP报文段无须分片就可达到目的主机。

## UDP数据段格式    

   UDP是一种不可靠的、无连接的数据报服务。源主机在传送数据前不需要和目标主机建立连接。数据被冠以源、目标端口号等UDP报头字段后直接发往目的主机。这时，每个数据段的可靠性依靠上层协议来保证。在传送数据较少、较小的情况下，UDP比TCP更加高效。   
下图为UDP的头部结构：  

报文头 8字节

![](http://img.blog.csdn.net/20140914125200039)

- 源、目标端口号字段：占16比特。作用与TCP数据段中的端口号字段相同，用来标识源端和目标端的应用进程。    
- 长度字段：占16比特。标明UDP头部和UDP数据的总长度字节。    
- 校验和字段：占16比特。用来对UDP头部和UDP数据进行校验。和TCP不同的是，对UDP来说，此字段是可选项，而TCP数据段中的校验和字段是必须有的 



## tcp 和 udp使用

- 区别

TCP（或传输控制协议）(Transmission Control Protocol) 和 UDP（或用户数据报协议）(User Datagram Protoco)。


 
TCP | UDP
-- | --
是否连接 面向连接 |   面向非连接
传输可靠性 | 可靠的 | 不可靠的
应用场合|  传输大量的数据 | 少量数据
速度| 慢 | 快

TCP协议和UDP协议特性区别总结：

1. TCP协议在传送数据段的时候要给段标号；UDP协议不
2. TCP协议可靠；UDP协议不可靠
3. TCP协议是面向连接；UDP协议采用无连接
4. TCP协议负载较高，采用虚电路；UDP采用无连接
5. TCP协议的发送方要确认接收方是否收到数据段（3次握手协议）
6. TCP协议采用窗口技术和流控制

TCP数据传输不同于UDP之处

1. 有序数据传输
1. 重发丢失的数据包
1. 舍弃重复的数据包
1. 无错误数据传输
1. 阻塞/流量控制
1. 面向连接（确认有创建三方交握，连接已创建才作传输。）

- 什么时候使用udp

总结来说，当网络差到一定程度了，TCP的优势反而会成为劣势。

UDP协议是无连接方式的协议，它的效率高，速度快，占资源少，但是其传输机制为不可靠传送，必须依靠辅助的算法来完成传输控制。QQ采用的通信协议以UDP为主，辅以TCP协议。由于QQ的服务器设计容量是海量级的应用，一台服务器要同时容纳十几万的并发连接，因此服务器端只有采用UDP协议与客户端进行通讯才能保证这种超大规模的服务。

UDP包能够穿透大部分的代理服务

QQ客户端之间的消息传送也采用了UDP模式，因为国内的网络环境非常复杂，而且很多用户采用的方式是通过代理服务器共享一条线路上网的方式，在这些复杂的情况下，客户端之间能彼此建立起来TCP连接的概率较小，严重影响传送信息的效率。而UDP包能够穿透大部分的代理服务器，因此QQ选择了UDP作为客户之间的主要通信协议。　


采用UDP协议，通过服务器中转方式。因此，现在的IP侦探在你仅仅跟对方发送聊天消息的时候是无法获取到IP的。大家都知道，UDP 协议是不可靠协议，它只管发送，不管对方是否收到的，但它的传输很高效。但是，作为聊天软件，怎么可以采用这样的不可靠方式来传输消息呢？于是，腾讯采用了上层协议来保证可靠传输：如果客户端使用UDP协议发出消息后，服务器收到该包，需要使用UDP协议发回一个应答包。如此来保证消息可以无遗漏传输。之所以会发生在客户端明明看到“消息发送失败”但对方又收到了这个消息的情况，就是因为客户端发出的消息服务器已经收到并转发成功，但客户端由于网络原因没有收到服务器的应答包引起的。





## 网络协议

[ 【网络协议】ICMP协议、Ping、Traceroute](http://blog.csdn.net/ns_code/article/details/30089245)

- ICMP协议

   ICMP报文大致分为两类：查询报文和差错报文。

子网掩码查询；
时间戳查询；
ping查询。

-  ping是ICMP的一个很著名的应用。

-  Traceroute是ICMP协议的另一个重要应用，

## 子网掩码与网络划分


例：学院新建4个机房，每个房间有25台机器，给定一个网络地址空间：192.168.10.0，现在需要将其划分为4个子网。

第一步：确定物理网段的数量，并将其转换为二进制数，并确定位数n。如：你需要6个子网，6的二进制值为110，共3位,即n=3，即向主机位借三位；

第二步：按照你ip地址的类型写出其缺省子网掩码。如192.168.10.0就是个C类，则缺省子网掩码为11111111.11111111.11111111.00000000；

第三步：将子网掩码中与主机号的前n位对应的位置置1，其余位置置0。若n=3且为C类地址：

则得到子网掩码为11111111.11111111.11111111.11100000化为十进制得到255.255.255.224

如下图(C类地址)：

![](http://www.dabu.info/wp-content/uploads/2013/08/clip_image002.jpg)


子网掩码-子网划分

这六个可用子网地址从二进制换算成十进制，如下：

```
11000000 10101000 00001010 00100000 = 192.168.10.32
11000000 10101000 00001010 01000000 = 192.168.10.64
11000000 10101000 00001010 01100000 = 192.168.10.96
11000000 10101000 00001010 10000000 = 192.168.10.128
11000000 10101000 00001010 10100000 = 192.168.10.160
11000000 10101000 00001010 11000000 = 192.168.10.192
```

注意在一个网络中主机地址全为0的IP是网络地址，全为1的IP是网络广播地址，不可用

## 七层网络模型

**[开放式系统互联通信参考模型](https://zh.wikipedia.org/wiki/OSI%E6%A8%A1%E5%9E%8B)**（英语：Open System Interconnection Reference Model，缩写为 OSI），简称为OSI模型（OSI model）

1. 第7层 应用层(Application Layer)
	主条目：应用层
	提供为应用软件而设的界面，以设置与另一应用软件之间的通信。例如: HTTP，HTTPS，FTP，TELNET，SSH，SMTP，POP3等。
1. 第6层 表示层(Presentation Layer)
	主条目：表示层
	把数据转换为能与接收者的系统格式兼容并适合传输的格式。
1. 第5层 会话层(Session Layer)
	主条目：会话层
	负责在数据传输中设置和维护电脑网络中两台电脑之间的通信连接。
1. 第4层 传输层(Transport Layer)
	主条目：传输层
	**把传输表头（TH）加至数据以形成数据包**。传输表头包含了所使用的协议等发送信息。例如:传输控制协议义（TCP）等。
	TCP/UDP协议
1. 第3层 网络层(Network Layer)
	主条目：网络层
	决定数据的路径选择和转寄，**将网络表头（NH）加至数据包，以形成分组**。网络表头包含了网络数据。例如:互联网协议（IP）等。
1. 第2层 数据链接层(Data Link Layer)
	主条目：数据链路层
	负责网络寻址、错误侦测和改错。**当表头和表尾被加至数据包时，会形成了帧**。数据链表头（DLH）是包含了物理地址和错误侦测及改错的方法。数据链表尾（DLT）是一串指示数据包末端的字符串。例如以太网、无线局域网（Wi-Fi）和通用分组无线服务（GPRS）等。
	分为两种子层：logic link control sublayer & media access control sublayer

	把数据链路层分成)两个子层

	1. 逻辑链路控制LLC(Logical Link Control)
	1. 介质访问控制MAC(Medium Access Control


1. 第1层 物理层(Physical Layer)
	主条目：物理层
	在局部局域网上传送帧，它负责管理电脑通信设备和网络媒体之间的互通。包括了针脚、电压、线缆规范、集线器、中继器、网卡、主机适配器等


## TCP/IP体系


1. 网络接口层: Ethernet,Token-ring
1. 网际层: IP
1. 传输层: TCP UDP
1. 应用层: HTTP,DNS

## TCP三次握手



## TCP/UDP区别


## 当同时连接/同时断开时如何发送信息


# 物理层

物理层功能：两个传输介质相连的节点间传输比特流(电信号)．

物理层定义了建立、维护和拆除物理电路以及位流传输、管理的 规范和标准．传输介质的接口的一些特性

RS-232、RJ45、RJ11、RS-449、V.24、V.35、G.703/G.704


  
调制：把数字信号转换为模拟信号的过程。
  
解调：把模拟信号转换为数字信号的过程。
  
编码：数据的数字信号变换过程。

信号传输速率B（波特率）-- 每秒传输的码元数，单位为波
B=1/T

(比特率）--每秒传输二进制信息的位数，单位为bit/s，记作bps
R=1/T * log 2 N

- 波特(Baud)和比特(bit)是两个不同的概念。
  
波特是码元传输的速率单位（每秒传多少个码元）; 码元传输速率也称为调制速率、波形速率或信号速率。
  
比特是二进制数据量的单位。
  
比特/秒（bit/s=bps）是数据传输速率

- 传输介质

同轴电缆 双绞线 
光纤: 单模,多模
模是指:以一定角速度进入光纤的一束光。

编码：用数字信号承载数字或模拟数据
  
调制：用模拟信号承载数字或模拟数据


- 数字数据的模拟信号编码: 数字信息变成模拟信号。
  
幅移键控（ASK） 频移键控（FSK）相移键控（PSK）
  
- 数字数据的数字信号编码

  
不归零码NRZ (Non Return to Zero)
  
差分不归零码DNRZ； 利用相位变化：一个信号位的起始处有跳变表示数据“1”，而无跳变表示数据“0”。：
许多高速网络系统采用了DNRZ。
  
曼彻斯特码：正的电压跳变表示“0”； 用负的电压跳变表示“1”。10Mb/s以太网采用曼彻斯特码
  
差分曼彻斯特码：令牌环网采用


  
- 模拟数据的数字信号编码： 模拟变数字
  
PCM： 脉冲编码调制PCM (Pulse Code Modulation)

采样：按一定间隔对语音信号进行采样
  
量化：把每个样本舍入到最接近的量化级别上
  
编码：对每个舍入后样本进行编码，编码后的信号称为PCM信号


- 多路复用技术

  
频分多路复用：按频率划分不同的信道，如CATV系统
  
时分多路复用：按时间划分不同的信道，目前应用最广泛
  
波分多路复用：按波长划分不同的信道，用于光纤传输
  
码分多路复用：按地址码划分不同的信道，非常有发展前途

  
单工(Simplex)—单向通信（例：无线电广播）
  
半双工(Half-duplex) 例：对讲机）
  
全双工(Full-duplex)—双向同时通信（例：电话）

- 数据交换技术
  
电路交换： 建立连接 通信  释放连接

报文交换  
 
分组交换： 数据划分固定长度数据段。注意含有分组首部。

**计算机网络通常是采用分组交换的，偶尔会用电 路交换，但绝对不会是报文交换。**


- 电路交换与分组交换区别
  
电路交换要求在通信之前要建立一条电路，分组 交换不要求预先建立任何连接，只要第一个分组 准备好了，就可以被发送出去。
  
电路交换中传输前建立连接的结果是，在发送方 和接受方的物理路径上预留了带宽。所有的数据 都沿着这条路径传输，这样数据到达目的端的顺 序不会打乱。分组交换中，由于每个分组独立发 送，因此到达目的端的顺


  
分组交换使用存储－转发机制。分组首先 保存在路由器内存中，然后转发给下一个 路由器。对于电路交换，所有的数据位只 是连续的流过线路。
  
分组交换比电路交换有更强的容错能力。
  
电路交换使得一条物理通路被预留给某个 特定用户，当没有流量通过这条线路时， 整个线路的带宽就会浪费，但是分组交换 不存在此问题。

- 差错处理技术
  

- 纠正错误方法
  
	1. 反馈重发纠错法 ： 重新发
	1. 前向纠错法差错处理技术： 纠错码纠错


# 数据链路

将不可靠的物理链路变成可靠的数据链 路。在两台相邻的机器之间实现可靠、有效的通信，将物理层的数据无错的传 给上层（网络层）。“相邻”指的是两台机器通过一条通信信道连接起来.

**数据拆分到数据帧**

链路层协议，**将不可靠的物理链路变成可靠的数据链路。**

- 物理层没有解决的问题.

1. 比特流分界为数据帧（成帧）
1. 位流传输过程中不可避免会出现差错（电磁干 扰、线路问题） （差错检测与纠正）
1. 数据收发之间的速率匹配问题（不同设备处理 速度不同） （流量控制）



成帧（帧定界）:数据链路层从网络层获得到分组，然后将 分组(packet)封装到帧(frame)以便传输，每一帧包含一个帧头、一个有效载荷(用于存放分组)，以及一个帧尾。

1. 字符计数法:利用头部的一个域来指明该帧中的字符数
1. 含字节填充的分界符法（面向字符的同步传输）:使用标志字节（flag byte）作为起始和结束分界符。
1. 含位填充的分界标志法（面向位流的同步传输）:每一帧的开始和结束都有一个特殊的位模式01111110。
1. 物理层编码违例法（物理编码冗余－曼彻斯特编码，通过使用不可能出现的编码来表示特定 状态

## 差错检测与纠正

差错检测
  
奇偶校验码
  
CRC循环冗余校验码

### 差错纠正：反馈重发纠错法
  
肯定应答
  
超时重发
  
帧编号


##  流量控制算法

由收方控制发方的数据流，乃是计算机网络中流量控制的一个基本方法。


1. 停止—等待协议

	等收到确认才发送下一个.

	- 带有差错控制的停止—等待协议工作流程
	超时重新发送数据帧
	接收方: 进行校验.

	- 解决重复帧问题: 帧带上发送序号,序号相同,丢弃.需要发送ACK.

	  
优点：比较简单。
  
缺点：通信信道的利用率不高，也就是 说，信道还远远没有被数据比特填满。
  
为了克服这一缺点，就产生了另外的协 议，即滑动窗口协议等。

1. 滑动窗口协议

  
前面的协议，解决了数据在一个方向上的 传输。但是大多数实际环境中，需要在两 个方向上传输数据——全双工信道。

- 接收站的应答两种实现方式：
  
单独应答方式，即接收站使用特定的应答帧进 行单独应答；
  
捎带应答方式，即接收站如果也有数据要发送 给对方，可以在通过数据帧中接收序号字段进 行捎带应答。


只有在接收窗口向前滑动时（与此同时也 发送了确认），发送窗口才有可能向前滑 动。


- 带差错控制的滑动窗口协议

在发送方发现有一帧出现错误

根据接收方窗口尺寸大小，有两种不同的策略
  
1. 接收窗口的大小为1，回退n帧（go back n）  
1. 接收窗口的大小大于1，选择性重传（selective repeat）


- 选择性重传的问题

1. 后退N帧协议

1. 选择重发协议

确保接收方向前移动窗口之后，新的窗口与老的窗口之间没有重叠。为了保 证没有重叠，最大的窗口尺寸应该不超过序列号 范围的一半。


IEEE802.3：以太网
  
IEEE802.4：令牌总线
  
IEEE802.5：令牌环
  
IEEE802.11 无线局域网

WAN数据链路层标准
  
HDLC
  
PPP
  
X.25
  
Frame Relay

- 数据链路层向网络层提供的三中可能的服务：

1. 无确认的无连接服务
	※不建立逻辑链接，接收方不确认，对丢失的帧不检测
	※适合于线路错误率很低，丢失帧检测可交由上层完成，就大多数LAN在数据链路层上都使用该服务。
2. 有确认的无连接服务
	※不建立逻辑链接，接收方确认，对丢失的帧可检测并要求发送方重发，适合不可靠的信道，比如无线系统。
3. 有确认的面向连接服务
	※建立逻辑链路，接收方确认，对丢失的帧可检测并要求发送方重发，并对帧进行差错检测和纠正

HDLC(High-level Data Link Control) 高级数据链路控制,面向比特的规程

- 面向比特的通信规程
  
1. 以比特作为传输控制信息的基本单元
1. 数据帧与控制帧格式相同   
1. 传输透明性好  
1. 连续发送，传输效率高

三种数据传送方式: 正常响应方式NRM,异步响应方式ARM,异步平衡方式ABM

### 因特网的点对点协议PPP

点对点协议PPP (Point-to-Point Protocol)
:现在全世界使用得最多的数据链路层协议

拨号电话线接入因特网,一般都是使用PPP 协议。

PPP 是面向字节的，所有的PPP 帧的长度都是整数字节。

- PPP协议有三个组成部分
  
1. 一个将IP 数据报封装到串行链路的方法。
1. 链路控制协议LCP (Link Control Protocol)。
1. 网络控制协议NCP (Network Control Protocol)。

- 透明传输问题

协议规定采用硬件来完成比特填充



# 局域网

局域网是指传输距离有限，传输效率较高，以共 享网络资源位目的网络系统。

IEEE 802 标准主要规定了物理层和数据链路层两个层次,

将数据链路层分成

1. 逻辑链路控制(LLC)
1. 介质访问控制(MAC)两个子层


### LLC协议（IEEE 802.2）

LLC层为所有的局域网提供公共的服务

而LLC帧被封装在MAC帧的信息字段中。
LLC帧中没有用于帧同步的标志字段以及用于验证帧正确性的帧校验字段；这些字段由MAC协议添加在MAC帧中

LLC协议只定义了一种数据传送操作方式.


### 以太网的MAC 子层（IEEE 802.3）

无论何种Ethernet，其MAC层均采用**争用型介质访问控制协议，即载波监听多点接入/冲突检测**CSMA/CD (Carrier Sense Multiple Access/Collision Detect)。

各种以太网的MAC层协议都采用了CSMA/CD协议，而在物理层协议上各有不同


**先听后发，边发边听，冲突停发，随机延迟后重发**

局域网:
采用较为灵活的无连接的工作方式，即不必先建立连接就可以直接发送数据。

以太网对发送的数据帧不进行编号，也不要求对方发回确认。

争用期的长度:以太网取51.2 us 为争用期的长度

以太网规定了最短有效帧长为64 字节，凡长度小于64 字节的帧都是由于冲突而异常中止的无效帧。


CSMA/CD协议帧结构

CSMA/CD协议工作原理


网卡的作用

网络接口板又称为通信适配器(adapter)或网络接口卡NIC (Network Interface Card)，或“网卡”。

- 网卡的重要功能：

1. 进行串行/并行转换。
1. 对数据进行缓存。 
1. 在计算机的操作系统安装设备驱动程序。
1. 实现以太网协议。


IEEE 802.3定义了两种传输类别

基带( BASE)：是数字信号（在以太网中使用曼彻斯特编码）

宽带(BROAD)：是模拟信号（以太网使用PSK编码）

任何两个收发器之间的路径不能跨越多于4个中继器

集线器



###　令牌环网（Token Ring）

介质访问控制协议

Token Ring采用令牌（Token）控制帧来解决网络中各个节点对传输介质的有序访问，不会发生任何介质访问冲突。

MAC子层帧格式

物理层规范

网络组成技术


FDDI：种高速令牌环网，具有较强的容错能力

### 无线局域网


无固定基础设施的无线局域网自组网络(ad hoc network)


- 无线局域网却不能使用CSMA/CD 协议

CSMA/CD 协议要求一个站点在发送本站数据的同时还必须不间断地检测信道，但在无线局域网 的设备中要实现这种功能就花费过大。

即使我们能够实现碰撞检测的功能，并且当我们 在发送数据时检测到信道是空闲的，在接收端仍 然有可能发生碰撞。


隐蔽站问题:A 和C 检测不到无线信号时，都以为B 是空闲的，
因而都向B 发送数据，结果发生碰撞。

暴露站问题:B 向A 发送数据，而C 又想和D 通信。
C 检测到媒体上有信号，于是就不敢向D 发送数据。


- 介质访问控制协议（CSMA/CA）

改进的办法是将CSMA 增加一个碰撞避免(Collision Avoidance)功能。


欲发送数据的站先检测信道。在802.11 标准中规定了在物理层的空中接口进行物理层的载波监听。

通过收到的相对信号强度是否超过一定的门限数 值就可判定是否有其他的移动站在信道上发送数据。

当源站发送它的第一个MAC 帧时，若检测到信道空闲，则在等待一段时间DIFS 后就可发送

假定没有高优先级帧要发送

源站发送了自己的数据帧。

目的站若正确收到此帧，则经过时间间隔 SIFS 后，向源站发送确认帧ACK。

若源站在规定时间内没有收到确认帧ACK （由重传计时器控制这段时间），就必须重传此帧，直到收到确认为止，或者经过 若干次的重传失败后放弃发送。

- 虚拟载波监听

虚拟载波监听(Virtual Carrier Sense)的机制是让源站将它要占用信道的时间（包括 目的站发回确认帧所需的时间）通知给所有其他站，以便使其他所有站在这一段时 间都停止发送数据。


802.11 使用二进制指数退避算法


### 码分复用CDMA

码分多址CDMA(Code Division Multiple Access)
每一个比特时间划分为m 个短的间隔，称为码片(chip)。




- 物理层网络连接设备

中继器和集线器:是一种信号整形（或再生）设备，主要功 能是延伸局域网段的物理距离。

采用CSMA/CD


- 数据链路层网络连接设备

网桥:两个局域网段之间的通信隔开，使得双方的结点之间很少通信，过滤通信量。
网桥使各网段成为隔离的冲突域，减小通信量

存储转发增加了时延


二层交换机: 表明此交换机工作在数据链路层
交换机在逻辑上可以看作是每个端口是一个网 桥。因此，以太网交换机实质上就是一个多端口的网桥。

功能;
具有过滤帧的功能。当收到一个帧时，并不是向所有的端口转发此帧，而是先检查 此帧的目的MAC 地址，然后再确定将该帧转发到哪一个端口


交换机的最大优点:
对于拥有N 对端口的交换机的总容量为： N* 10 Mb/s

交换机: 连接到同一个交换机的网段属于不同的冲 突域，但是它们属于同一个广播域，因为 交换机允许广播帧在网络中传输。因此也 有可能出现**广播风暴**。

- 虚拟局域网

虚拟局域网的概念

虚拟局域网 VLAN 是由一些局域网网段构成的与物理位置无关的逻辑组

- 通过VLAN划分广播域

VLAN隔离了二层广播域，也就严格地隔离了各个 VLAN之间的任何流量，分属于不同VLAN的用户不 能互相通信


虚拟局域网使用的以太网帧格式


# 网络层

关键的问题是确定如何将分组从 源端路由到目标端。

数据链路层只负责同一个网络 （链路）上两个系统之间报文的 传递，而网络层要保证每个报文 能够从出发点到达目的地。


- 需要解决的问题

路由选择

拥塞控制

异种网络互联


无连接的数据传输服务（IP）：数据报方式

网络层的主要功能是将分组从源机器路由到目标机器中

- 静态路由选择算法:常称为非自适应的算法（non-adaptive algorithm）

	1. 最短路径选择算法SP (Shortest Path)
	1. 基于流量的选择算法FR (Flow-based Routing)

- 动态路由选择算法:自适应的算法

	1. 距离矢量路由选择算法DVR (Distance Vector Routing)
	1. 链路状态路由选择算法LSR (Line State Routing)
 
# 传输层

# 会话层
 
# 表示层
 
# 应用层

# 流控制


